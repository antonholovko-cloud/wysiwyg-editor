<div class="wysiwyg-editor-container">
  <div class="wysiwyg-toolbar" *ngIf="config.showToolbar !== false">
    <ng-container *ngFor="let cmd of commands">
      <div class="toolbar-separator" *ngIf="cmd.command === 'separator'"></div>
      <button
        *ngIf="cmd.command !== 'separator'"
        class="toolbar-button"
        [class.active]="isCommandActive(cmd.command)"
        [disabled]="disabled"
        [title]="cmd.tooltip || cmd.command"
        (mousedown)="$event.preventDefault(); $event.stopPropagation()"
        (click)="executeCommand(cmd, $event); $event.preventDefault(); $event.stopPropagation()"
        type="button">
        <span [innerHTML]="getSafeHtml(cmd.icon || cmd.command)"></span>
      </button>
    </ng-container>
    
    <div class="color-picker-dropdown" *ngIf="showColorPicker">
      <input type="color" [(ngModel)]="selectedColor" (change)="applyTextColor()">
      <button (click)="applyTextColor()" type="button">Apply</button>
      <button (click)="showColorPicker = false" type="button">Cancel</button>
    </div>
    
    <div class="color-picker-dropdown" *ngIf="showBackgroundColorPicker">
      <input type="color" [(ngModel)]="selectedBackgroundColor" (change)="applyBackgroundColor()">
      <button (click)="applyBackgroundColor()" type="button">Apply</button>
      <button (click)="showBackgroundColorPicker = false" type="button">Cancel</button>
    </div>
  </div>
  
  <div 
    #editor
    class="wysiwyg-editor-content"
    [style.height]="config.height"
    [style.minHeight]="config.minHeight"
    [style.maxHeight]="config.maxHeight"
    [attr.placeholder]="config.placeholder"
    [class.disabled]="disabled"
    contenteditable="true">
  </div>
  
  <div class="link-dialog" *ngIf="showLinkDialog">
    <div class="link-dialog-content">
      <h3>Insert Link</h3>
      <input 
        #linkUrlInput
        type="url" 
        [(ngModel)]="linkUrl" 
        placeholder="https://example.com"
        (keyup.enter)="insertLink()">
      <div class="link-dialog-buttons">
        <button (click)="insertLink()" [disabled]="!linkUrl" type="button">Insert</button>
        <button (click)="closeLinkDialog()" type="button">Cancel</button>
      </div>
    </div>
  </div>
  
  <div class="padding-dialog" *ngIf="showPaddingDialog">
    <div class="padding-dialog-content">
      <h3>Set Padding</h3>
      <div class="padding-all-group">
        <label for="paddingAll">All sides (px):</label>
        <input 
          id="paddingAll"
          type="number" 
          [(ngModel)]="paddingAll" 
          (ngModelChange)="onPaddingAllChange()"
          min="0"
          placeholder="Set all paddings at once">
      </div>
      <div class="padding-separator">or set individual paddings:</div>
      <div class="padding-grid">
        <div class="padding-input-group">
          <label for="paddingTop">Top (px):</label>
          <input 
            id="paddingTop"
            type="number" 
            [(ngModel)]="paddingTop" 
            min="0"
            placeholder="0">
        </div>
        <div class="padding-input-group">
          <label for="paddingRight">Right (px):</label>
          <input 
            id="paddingRight"
            type="number" 
            [(ngModel)]="paddingRight" 
            min="0"
            placeholder="0">
        </div>
        <div class="padding-input-group">
          <label for="paddingBottom">Bottom (px):</label>
          <input 
            id="paddingBottom"
            type="number" 
            [(ngModel)]="paddingBottom" 
            min="0"
            placeholder="0">
        </div>
        <div class="padding-input-group">
          <label for="paddingLeft">Left (px):</label>
          <input 
            id="paddingLeft"
            type="number" 
            [(ngModel)]="paddingLeft" 
            min="0"
            placeholder="0">
        </div>
      </div>
      <div class="padding-dialog-buttons">
        <button (click)="applyPadding()" type="button">Apply</button>
        <button (click)="closePaddingDialog()" type="button">Cancel</button>
      </div>
    </div>
  </div>
  
  <div class="document-padding-dialog" *ngIf="showDocumentPaddingDialog">
    <div class="document-padding-dialog-content">
      <h3>Set Document Padding</h3>
      <div class="padding-all-group">
        <label for="documentPaddingAll">All sides (px):</label>
        <input 
          id="documentPaddingAll"
          type="number" 
          [(ngModel)]="documentPaddingAll" 
          (ngModelChange)="onDocumentPaddingAllChange()"
          min="0"
          placeholder="Set all paddings at once">
      </div>
      <div class="padding-separator">or set individual paddings:</div>
      <div class="padding-grid">
        <div class="padding-input-group">
          <label for="documentPaddingTop">Top (px):</label>
          <input 
            id="documentPaddingTop"
            type="number" 
            [(ngModel)]="documentPaddingTop" 
            min="0"
            placeholder="0">
        </div>
        <div class="padding-input-group">
          <label for="documentPaddingRight">Right (px):</label>
          <input 
            id="documentPaddingRight"
            type="number" 
            [(ngModel)]="documentPaddingRight" 
            min="0"
            placeholder="0">
        </div>
        <div class="padding-input-group">
          <label for="documentPaddingBottom">Bottom (px):</label>
          <input 
            id="documentPaddingBottom"
            type="number" 
            [(ngModel)]="documentPaddingBottom" 
            min="0"
            placeholder="0">
        </div>
        <div class="padding-input-group">
          <label for="documentPaddingLeft">Left (px):</label>
          <input 
            id="documentPaddingLeft"
            type="number" 
            [(ngModel)]="documentPaddingLeft" 
            min="0"
            placeholder="0">
        </div>
      </div>
      <div class="padding-dialog-buttons">
        <button (click)="applyDocumentPadding()" type="button">Apply</button>
        <button (click)="closeDocumentPaddingDialog()" type="button">Cancel</button>
      </div>
    </div>
  </div>
  
  <div class="html-dialog" *ngIf="showHtmlDialog">
    <div class="html-dialog-content">
      <h3>View/Edit HTML</h3>
      <textarea 
        [(ngModel)]="htmlContent" 
        placeholder="Enter HTML code here..."
        rows="10"
        class="html-textarea">
      </textarea>
      <div class="html-dialog-buttons">
        <button (click)="insertHtml()" type="button">Apply Changes</button>
        <button (click)="closeHtmlDialog()" type="button">Cancel</button>
      </div>
    </div>
  </div>
  
  <div class="preview-dialog" *ngIf="showPreview">
    <div class="preview-dialog-overlay" (click)="closePreview()"></div>
    <div class="preview-dialog-content">
      <div class="preview-header">
        <h3>Preview</h3>
        <button class="preview-close" (click)="closePreview()" type="button">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="preview-body">
        <div class="preview-content" [innerHTML]="getPreviewContent()"></div>
      </div>
    </div>
  </div>
</div>